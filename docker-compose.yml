services:
  mongodb:
    container_name: mongodb
    image: docker.io/library/mongo
    ports:
      - 27017:27017
    environment:
      MONGO_INITDB_ROOT_USERNAME: api
      MONGO_INITDB_ROOT_PASSWORD: N6QmF7kSNGLq
    volumes:
      - mongo_db_data:/data/db
    networks:
      - car-charging-network
  api:
      container_name: api
      build: ./API
      image: api
      working_dir: /usr/src/app      
      volumes:
        - API:/usr/src/app
      ports:
        - 5000:5000
      command: npm run dev
      depends_on:
        - mongodb
      networks:
        - car-charging-network
  front:
      container_name: front
      build: ./FRONT
      image: front
      depends_on:
        - api
      volumes:
        - ./FRONT:/usr/src/app
        - astro_node_modules:/app/node_modules
      ports:
        - 4321:4321
      environment:
        - PUBLIC_API_URL=http://localhost:5000
      command: npm run dev
      networks:
        - car-charging-network 
volumes:
  mongo_db_data:
    driver: local
  API:
  FRONT:
  astro_node_modules:

networks:
  car-charging-network:
    driver: bridge
  
  
  #podman-compose down && podman rmi --all && podman-compose up -d --build --no-cache && podman-compose logs -f
 
